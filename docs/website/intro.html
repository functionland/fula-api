<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Introduction - Fula API Documentation</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/intro.css">
    <script>
        (function() {
            const saved = localStorage.getItem('fula-docs-theme');
            if (saved) document.documentElement.setAttribute('data-theme', saved);
        })();
    </script>
</head>
<body>
    <!-- Mobile Header -->
    <header class="mobile-header">
        <button class="hamburger" aria-label="Toggle menu">
            <span></span>
            <span></span>
            <span></span>
        </button>
        <span class="logo-text">Fula API</span>
        <div class="mobile-header-actions">
            <button class="theme-toggle" aria-label="Toggle theme">
                <span class="icon-sun">‚òÄÔ∏è</span>
                <span class="icon-moon">üåô</span>
            </button>
        </div>
    </header>
    
    <div class="sidebar-overlay"></div>
    
    <nav class="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <h1>Fula API</h1>
                <span class="version">v0.1.0</span>
            </div>
            <button class="theme-toggle" aria-label="Toggle theme">
                <span class="icon-sun">‚òÄÔ∏è</span>
                <span class="icon-moon">üåô</span>
            </button>
        </div>
        <div class="nav-section">
            <h3>Documentation</h3>
            <ul>
                <li><a href="intro.html" class="active">Introduction</a></li>
                <li><a href="index.html">API Reference</a></li>
                <li><a href="sdk.html">SDK Examples</a></li>
                <li><a href="platforms.html">Platform Guides</a></li>
            </ul>
        </div>
        <div class="nav-section">
            <h3>On This Page</h3>
            <ul>
                <li><a href="#overview">Overview</a></li>
                <li><a href="#why-fula">Why Fula?</a></li>
                <li><a href="#architecture">Architecture</a></li>
                <li><a href="#how-it-works">How It Works</a></li>
                <li><a href="#encryption">Encryption</a></li>
                <li><a href="#data-structures">Data Structures</a></li>
                <li><a href="#getting-started">Getting Started</a></li>
            </ul>
        </div>
    </nav>

    <main class="content intro-content">
        <!-- Hero Section -->
        <section class="hero">
            <div class="hero-content">
                <h1>Fula Storage API</h1>
                <p class="hero-subtitle">S3-Compatible Decentralized Storage Engine powered by IPFS</p>
                <div class="hero-badges">
                    <span class="badge-item">üåê Decentralized</span>
                    <span class="badge-item">üîí End-to-End Encrypted</span>
                    <span class="badge-item">‚úÖ Verifiable</span>
                    <span class="badge-item">üîÑ Conflict-Free</span>
                </div>
                <div class="hero-actions">
                    <a href="index.html" class="btn btn-primary">API Reference</a>
                    <a href="#getting-started" class="btn btn-secondary">Get Started</a>
                </div>
            </div>
        </section>

        <!-- Overview Section -->
        <section id="overview" class="intro-section">
            <h2>Overview</h2>
            <div class="overview-grid">
                <div class="overview-text">
                    <p>Fula Storage provides an <strong>Amazon S3-compatible API</strong> backed by a decentralized network of IPFS nodes. It enables developers to build applications using familiar S3 tools and SDKs while benefiting from true data ownership and decentralization.</p>
                    <p>Unlike traditional cloud storage where your data lives on servers controlled by a single company, Fula distributes your data across a network of <strong>individually owned nodes</strong>. You maintain full control over your data with client-side encryption.</p>
                </div>
                <div class="overview-features">
                    <div class="feature-card">
                        <div class="feature-icon">üåê</div>
                        <h3>Decentralized Storage</h3>
                        <p>Data stored across a network of community-owned IPFS nodes. No single point of failure or control.</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">üîí</div>
                        <h3>End-to-End Encryption</h3>
                        <p>HPKE encryption happens on your device. Storage nodes never see your plaintext data.</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">‚úÖ</div>
                        <h3>Verified Streaming</h3>
                        <p>BLAKE3/Bao ensures data integrity. Detect tampering even from untrusted nodes.</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">üîÑ</div>
                        <h3>Conflict-Free Sync</h3>
                        <p>CRDT-based metadata enables distributed updates without coordination.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Why Fula Section -->
        <section id="why-fula" class="intro-section alt-bg">
            <h2>Why Fula?</h2>
            <div class="comparison-table">
                <table>
                    <thead>
                        <tr>
                            <th>Feature</th>
                            <th>Traditional Cloud (S3, GCS)</th>
                            <th>Fula Storage</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Data Location</td>
                            <td>Corporate data centers</td>
                            <td class="highlight">Distributed across community nodes</td>
                        </tr>
                        <tr>
                            <td>Data Control</td>
                            <td>Provider can access your data</td>
                            <td class="highlight">Only you can decrypt your data</td>
                        </tr>
                        <tr>
                            <td>Encryption</td>
                            <td>Server-side (provider holds keys)</td>
                            <td class="highlight">Client-side (you hold keys)</td>
                        </tr>
                        <tr>
                            <td>Censorship</td>
                            <td>Provider can delete/restrict</td>
                            <td class="highlight">Content-addressed, censorship-resistant</td>
                        </tr>
                        <tr>
                            <td>Vendor Lock-in</td>
                            <td>Proprietary APIs</td>
                            <td class="highlight">S3-compatible, use any SDK</td>
                        </tr>
                        <tr>
                            <td>Data Integrity</td>
                            <td>Trust the provider</td>
                            <td class="highlight">Cryptographically verifiable</td>
                        </tr>
                        <tr>
                            <td>Single Point of Failure</td>
                            <td>Yes</td>
                            <td class="highlight">No - distributed network</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Architecture Section -->
        <section id="architecture" class="intro-section">
            <h2>Architecture</h2>
            <div class="architecture-diagram">
                <div class="arch-layer app-layer">
                    <div class="layer-label">Application Layer</div>
                    <div class="layer-content">
                        <span class="tech-badge">boto3</span>
                        <span class="tech-badge">AWS SDK</span>
                        <span class="tech-badge">MinIO SDK</span>
                        <span class="tech-badge">cURL</span>
                        <span class="tech-badge">Any S3 Client</span>
                    </div>
                </div>
                <div class="arch-arrow">‚Üì</div>
                <div class="arch-layer gateway-layer">
                    <div class="layer-label">Fula Gateway</div>
                    <div class="layer-components">
                        <div class="component">
                            <strong>Auth</strong>
                            <span>JWT / API Keys</span>
                        </div>
                        <div class="component">
                            <strong>Rate Limiter</strong>
                            <span>Request throttling</span>
                        </div>
                        <div class="component">
                            <strong>S3 Handlers</strong>
                            <span>API compatibility</span>
                        </div>
                    </div>
                </div>
                <div class="arch-arrow">‚Üì</div>
                <div class="arch-layer core-layer">
                    <div class="layer-label">fula-core</div>
                    <div class="layer-components">
                        <div class="component">
                            <strong>Prolly Trees</strong>
                            <span>O(log n) indexing</span>
                        </div>
                        <div class="component">
                            <strong>Buckets</strong>
                            <span>Object management</span>
                        </div>
                        <div class="component">
                            <strong>CRDTs</strong>
                            <span>Conflict-free sync</span>
                        </div>
                    </div>
                </div>
                <div class="arch-arrow">‚Üì</div>
                <div class="arch-layer blockstore-layer">
                    <div class="layer-label">fula-blockstore</div>
                    <div class="layer-components">
                        <div class="component">
                            <strong>IPFS Client</strong>
                            <span>Block storage</span>
                        </div>
                        <div class="component">
                            <strong>IPFS Cluster</strong>
                            <span>Replication</span>
                        </div>
                        <div class="component">
                            <strong>Chunking</strong>
                            <span>Content-defined</span>
                        </div>
                    </div>
                </div>
                <div class="arch-arrow">‚Üì</div>
                <div class="arch-layer crypto-layer">
                    <div class="layer-label">fula-crypto</div>
                    <div class="layer-components">
                        <div class="component">
                            <strong>HPKE</strong>
                            <span>Hybrid encryption</span>
                        </div>
                        <div class="component">
                            <strong>BLAKE3</strong>
                            <span>Fast hashing</span>
                        </div>
                        <div class="component">
                            <strong>Bao</strong>
                            <span>Streaming verification</span>
                        </div>
                    </div>
                </div>
                <div class="arch-arrow">‚Üì</div>
                <div class="arch-layer ipfs-layer">
                    <div class="layer-label">IPFS Network</div>
                    <div class="layer-content">
                        <div class="node-grid">
                            <span class="node">üì¶ Node</span>
                            <span class="node">üì¶ Node</span>
                            <span class="node">üì¶ Node</span>
                            <span class="node">üì¶ Node</span>
                            <span class="node">üì¶ Node</span>
                            <span class="node">üì¶ ...</span>
                        </div>
                        <p class="layer-desc">Decentralized network of community-owned storage nodes</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- How It Works Section -->
        <section id="how-it-works" class="intro-section alt-bg">
            <h2>How It Works</h2>
            <div class="flow-diagram">
                <div class="flow-step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <h3>Client-Side Encryption (Optional)</h3>
                        <p>If encryption is enabled, data is encrypted locally using HPKE <strong>before</strong> leaving your device. Only you hold the keys.</p>
                        <code>encrypted_data = encrypt(plaintext, your_public_key)</code>
                    </div>
                </div>
                <div class="flow-connector"></div>
                <div class="flow-step">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <h3>Upload to Gateway</h3>
                        <p>Your app sends a standard S3 PUT request to the Fula gateway. The gateway receives encrypted (or plain) bytes.</p>
                        <code>PUT /my-bucket/photo.jpg ‚Üí Gateway</code>
                    </div>
                </div>
                <div class="flow-connector"></div>
                <div class="flow-step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <h3>Content Chunking</h3>
                        <p>Large files are split into content-defined chunks for efficient deduplication and transfer.</p>
                        <code>FastCDC chunking ‚Üí [chunk1, chunk2, ...]</code>
                    </div>
                </div>
                <div class="flow-connector"></div>
                <div class="flow-step">
                    <div class="step-number">4</div>
                    <div class="step-content">
                        <h3>Content Addressing</h3>
                        <p>Each chunk gets a unique CID (Content Identifier) based on its BLAKE3 hash.</p>
                        <code>CID = hash(chunk_data)</code>
                    </div>
                </div>
                <div class="flow-connector"></div>
                <div class="flow-step">
                    <div class="step-number">5</div>
                    <div class="step-content">
                        <h3>Distributed Storage</h3>
                        <p>Chunks are stored across multiple IPFS nodes with configurable replication.</p>
                        <code>IPFS Cluster ‚Üí replicate(chunk, n_copies)</code>
                    </div>
                </div>
                <div class="flow-connector"></div>
                <div class="flow-step">
                    <div class="step-number">6</div>
                    <div class="step-content">
                        <h3>Metadata Indexing</h3>
                        <p>Object metadata is stored in Prolly Trees for efficient O(log n) lookups and CRDT sync.</p>
                        <code>prolly_tree.insert(key, metadata)</code>
                    </div>
                </div>
            </div>
        </section>

        <!-- Encryption Section -->
        <section id="encryption" class="intro-section">
            <h2>Encryption & Security</h2>
            <div class="encryption-grid">
                <div class="encryption-card">
                    <h3>üîê HPKE (Hybrid Public Key Encryption)</h3>
                    <p>RFC 9180 compliant encryption combining:</p>
                    <ul>
                        <li><strong>X25519</strong> - Elliptic curve Diffie-Hellman key exchange</li>
                        <li><strong>HKDF-SHA256</strong> - Key derivation</li>
                        <li><strong>ChaCha20-Poly1305</strong> - Authenticated encryption</li>
                    </ul>
                    <div class="code-block">
                        <pre>// Encrypt for recipient
sealed = hpke.seal(recipient_public_key, plaintext)

// Only recipient can decrypt
plaintext = hpke.open(recipient_secret_key, sealed)</pre>
                    </div>
                </div>
                <div class="encryption-card">
                    <h3>‚ö° BLAKE3 Hashing</h3>
                    <p>Modern cryptographic hash function:</p>
                    <ul>
                        <li><strong>Fast</strong> - Faster than MD5, SHA-1, SHA-256</li>
                        <li><strong>Secure</strong> - 256-bit security level</li>
                        <li><strong>Parallelizable</strong> - Scales with CPU cores</li>
                        <li><strong>Verified streaming</strong> - Incremental verification</li>
                    </ul>
                </div>
                <div class="encryption-card">
                    <h3>üìä Bao Streaming Verification</h3>
                    <p>Verified streaming for large files:</p>
                    <ul>
                        <li>Verify data <strong>before fully downloading</strong></li>
                        <li>Detect corruption in <strong>any chunk</strong></li>
                        <li>Works with <strong>untrusted sources</strong></li>
                        <li>Based on <strong>Merkle trees</strong></li>
                    </ul>
                </div>
                <div class="encryption-card">
                    <h3>üîë Key Management</h3>
                    <p>You control your encryption keys:</p>
                    <ul>
                        <li><strong>KEK</strong> - Key Encryption Key (your master key)</li>
                        <li><strong>DEK</strong> - Data Encryption Key (per-object)</li>
                        <li><strong>Key wrapping</strong> - DEKs encrypted with KEK</li>
                        <li><strong>Sharing</strong> - Encrypt DEK for recipients</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Data Structures Section -->
        <section id="data-structures" class="intro-section alt-bg">
            <h2>Data Structures</h2>
            <div class="ds-grid">
                <div class="ds-card">
                    <h3>üå≥ Prolly Trees</h3>
                    <p>Probabilistic B-trees for verifiable indexing:</p>
                    <ul>
                        <li><strong>O(log n)</strong> insert, lookup, delete</li>
                        <li><strong>Deterministic structure</strong> from content</li>
                        <li><strong>Efficient diffs</strong> between versions</li>
                        <li><strong>Merkle proofs</strong> for any key-value pair</li>
                    </ul>
                    <div class="ds-diagram">
                        <pre>        [root hash]
        /         \
   [node A]    [node B]
   /    \      /    \
[leaf] [leaf] [leaf] [leaf]</pre>
                    </div>
                </div>
                <div class="ds-card">
                    <h3>üîÑ CRDTs (Conflict-Free Replicated Data Types)</h3>
                    <p>Enable distributed updates without coordination:</p>
                    <ul>
                        <li><strong>Eventually consistent</strong> across nodes</li>
                        <li><strong>Automatic conflict resolution</strong></li>
                        <li><strong>Offline-first</strong> - sync when connected</li>
                        <li><strong>LWW-Register</strong> for metadata</li>
                    </ul>
                    <div class="ds-diagram">
                        <pre>Node A: set(key, "v1", t=1)
Node B: set(key, "v2", t=2)
        ‚Üì merge
Result: key = "v2" (latest timestamp wins)</pre>
                    </div>
                </div>
                <div class="ds-card">
                    <h3>üì¶ Content-Defined Chunking</h3>
                    <p>FastCDC algorithm for efficient deduplication:</p>
                    <ul>
                        <li><strong>Rolling hash</strong> finds chunk boundaries</li>
                        <li><strong>Shift-resistant</strong> - small changes = few new chunks</li>
                        <li><strong>Configurable size</strong> - 256KB default</li>
                        <li><strong>Deduplication</strong> across all files</li>
                    </ul>
                    <div class="ds-diagram">
                        <pre>File: [=====|====|======|===]
           ‚Üì content-defined boundaries
Chunks: [CID1] [CID2] [CID3] [CID4]</pre>
                    </div>
                </div>
            </div>
        </section>

        <!-- Getting Started Section -->
        <section id="getting-started" class="intro-section">
            <h2>Getting Started</h2>
            
            <!-- Row 1: Setup -->
            <h3 class="section-subtitle">1. Setup Your Environment</h3>
            <div class="getting-started-grid setup-row">
                <div class="gs-card">
                    <h3>üê≥ Docker Compose</h3>
                    <p>Quickest way to run locally:</p>
                    <div class="code-block">
                        <pre>git clone https://github.com/functionland/fula-api
cd fula-api
docker-compose up -d</pre>
                    </div>
                </div>
                <div class="gs-card">
                    <h3>üîß From Source</h3>
                    <p>Build and run with Cargo:</p>
                    <div class="code-block">
                        <pre>cargo build --release
./target/release/fula-cli serve</pre>
                    </div>
                </div>
                <div class="gs-card">
                    <h3>‚öôÔ∏è Configuration</h3>
                    <p>Environment variables:</p>
                    <div class="code-block">
                        <pre>FULA_HOST=0.0.0.0
FULA_PORT=9000
IPFS_API_URL=http://localhost:5001
JWT_SECRET=your-secret-key</pre>
                    </div>
                </div>
            </div>

            <!-- Row 2: Quick Start Code Example -->
            <h3 class="section-subtitle">2. Upload & Manage Photos (JavaScript)</h3>
            <div class="quickstart-code">
                <div class="code-header">
                    <span class="code-title">üì∏ Complete Example: Encrypt, Upload, and List Photos</span>
                    <span class="code-lang">JavaScript / TypeScript</span>
                </div>
                <div class="code-block large">
                    <pre><span class="code-comment">// 1. Install dependencies</span>
<span class="code-comment">// npm install @aws-sdk/client-s3 crypto-js</span>

import { S3Client, PutObjectCommand, ListObjectsV2Command } from '@aws-sdk/client-s3';

<span class="code-comment">// 2. Configure the Fula client</span>
const fula = new S3Client({
  endpoint: 'http://localhost:9000',
  region: 'us-east-1',
  credentials: {
    accessKeyId: 'YOUR_ACCESS_KEY',
    secretAccessKey: 'YOUR_SECRET_KEY',
  },
  forcePathStyle: true,
});

const BUCKET = 'my-photos';

<span class="code-comment">// 3. Helper: Encrypt data before upload (client-side encryption)</span>
async function encryptData(data: ArrayBuffer, password: string): Promise&lt;ArrayBuffer&gt; {
  const encoder = new TextEncoder();
  const keyMaterial = await crypto.subtle.importKey(
    'raw', encoder.encode(password), 'PBKDF2', false, ['deriveKey']
  );
  const key = await crypto.subtle.deriveKey(
    { name: 'PBKDF2', salt: encoder.encode('fula-salt'), iterations: 100000, hash: 'SHA-256' },
    keyMaterial, { name: 'AES-GCM', length: 256 }, false, ['encrypt']
  );
  const iv = crypto.getRandomValues(new Uint8Array(12));
  const encrypted = await crypto.subtle.encrypt({ name: 'AES-GCM', iv }, key, data);
  <span class="code-comment">// Prepend IV to encrypted data</span>
  const result = new Uint8Array(iv.length + encrypted.byteLength);
  result.set(iv);
  result.set(new Uint8Array(encrypted), iv.length);
  return result.buffer;
}

<span class="code-comment">// 4. Upload an encrypted photo</span>
async function uploadPhoto(filename: string, photoData: ArrayBuffer, password: string) {
  console.log(`üì§ Encrypting and uploading: ${filename}`);
  
  <span class="code-comment">// Encrypt locally BEFORE sending to gateway</span>
  const encryptedData = await encryptData(photoData, password);
  
  await fula.send(new PutObjectCommand({
    Bucket: BUCKET,
    Key: `photos/${filename}`,
    Body: new Uint8Array(encryptedData),
    ContentType: 'application/octet-stream', <span class="code-comment">// Encrypted = opaque bytes</span>
    Metadata: {
      'x-amz-meta-encrypted': 'true',
      'x-amz-meta-original-type': 'image/jpeg',
    },
  }));
  
  console.log(`‚úÖ Uploaded: photos/${filename}`);
}

<span class="code-comment">// 5. List all photos in the folder</span>
async function listPhotos() {
  console.log('üìÇ Listing photos folder...');
  
  const response = await fula.send(new ListObjectsV2Command({
    Bucket: BUCKET,
    Prefix: 'photos/',
  }));
  
  const files = response.Contents || [];
  console.log(`Found ${files.length} photo(s):`);
  files.forEach(file =&gt; {
    console.log(`  üì∑ ${file.Key} (${file.Size} bytes)`);
  });
  
  return files;
}

<span class="code-comment">// 6. Run the complete workflow</span>
async function main() {
  const password = 'my-secret-encryption-key';
  
  <span class="code-comment">// Simulate photo data (in real app, read from file/camera)</span>
  const photo1 = new TextEncoder().encode('fake-jpeg-data-for-sunset.jpg');
  const photo2 = new TextEncoder().encode('fake-jpeg-data-for-beach.jpg');
  
  <span class="code-comment">// Upload first photo (encrypted)</span>
  await uploadPhoto('sunset.jpg', photo1.buffer, password);
  
  <span class="code-comment">// List folder - should show 1 photo</span>
  await listPhotos();
  <span class="code-comment">// Output: Found 1 photo(s): üì∑ photos/sunset.jpg</span>
  
  <span class="code-comment">// Upload second photo (encrypted)</span>
  await uploadPhoto('beach.jpg', photo2.buffer, password);
  
  <span class="code-comment">// List folder again - should show 2 photos</span>
  await listPhotos();
  <span class="code-comment">// Output: Found 2 photo(s): üì∑ photos/sunset.jpg, üì∑ photos/beach.jpg</span>
}

main().catch(console.error);</pre>
                </div>
                <div class="code-output">
                    <div class="output-header">Expected Output</div>
                    <pre>üì§ Encrypting and uploading: sunset.jpg
‚úÖ Uploaded: photos/sunset.jpg
üìÇ Listing photos folder...
Found 1 photo(s):
  üì∑ photos/sunset.jpg (156 bytes)

üì§ Encrypting and uploading: beach.jpg
‚úÖ Uploaded: photos/beach.jpg
üìÇ Listing photos folder...
Found 2 photo(s):
  üì∑ photos/sunset.jpg (156 bytes)
  üì∑ photos/beach.jpg (152 bytes)</pre>
                </div>
            </div>

            <div class="next-steps">
                <h3>Next Steps</h3>
                <div class="next-links">
                    <a href="index.html" class="next-link">
                        <span class="next-icon">üìñ</span>
                        <span class="next-text">
                            <strong>API Reference</strong>
                            <span>Complete endpoint documentation</span>
                        </span>
                    </a>
                    <a href="sdk.html" class="next-link">
                        <span class="next-icon">üíª</span>
                        <span class="next-text">
                            <strong>SDK Examples</strong>
                            <span>Rust, Python, JavaScript code</span>
                        </span>
                    </a>
                    <a href="platforms.html" class="next-link">
                        <span class="next-icon">üì±</span>
                        <span class="next-text">
                            <strong>Platform Guides</strong>
                            <span>Next.js, React Native, .NET, more</span>
                        </span>
                    </a>
                </div>
            </div>
        </section>

        <footer>
            <p>Fula API Documentation ‚Ä¢ Built with ‚ù§Ô∏è for decentralized storage</p>
            <p class="footer-links">
                <a href="https://github.com/functionland/fula-api">GitHub</a> ‚Ä¢
                <a href="https://fx.land">Functionland</a>
            </p>
        </footer>
    </main>

    <script src="js/app.js"></script>
</body>
</html>
